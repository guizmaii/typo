/**
 * File automatically generated by `typo` for its own test suite.
 *
 * IF YOU CHANGE THIS FILE YOUR CHANGES WILL BE OVERWRITTEN
 */
package testdb
package postgres
package pg_catalog

import anorm.RowParser
import anorm.Success
import org.postgresql.util.PGobject
import play.api.libs.json.JsObject
import play.api.libs.json.JsResult
import play.api.libs.json.JsValue
import play.api.libs.json.Json
import play.api.libs.json.OFormat
import scala.util.Try

case class PgDatabaseRow(
  oid: PgDatabaseId,
  datname: String,
  datdba: Long,
  encoding: Int,
  datcollate: String,
  datctype: String,
  datistemplate: Boolean,
  datallowconn: Boolean,
  datconnlimit: Int,
  datlastsysoid: Long,
  datfrozenxid: PGobject,
  datminmxid: PGobject,
  dattablespace: Long,
  datacl: Option[Array[PGobject]]
)

object PgDatabaseRow {
  def rowParser(prefix: String): RowParser[PgDatabaseRow] = { row =>
    Success(
      PgDatabaseRow(
        oid = row[PgDatabaseId](prefix + "oid"),
        datname = row[String](prefix + "datname"),
        datdba = row[Long](prefix + "datdba"),
        encoding = row[Int](prefix + "encoding"),
        datcollate = row[String](prefix + "datcollate"),
        datctype = row[String](prefix + "datctype"),
        datistemplate = row[Boolean](prefix + "datistemplate"),
        datallowconn = row[Boolean](prefix + "datallowconn"),
        datconnlimit = row[Int](prefix + "datconnlimit"),
        datlastsysoid = row[Long](prefix + "datlastsysoid"),
        datfrozenxid = row[PGobject](prefix + "datfrozenxid"),
        datminmxid = row[PGobject](prefix + "datminmxid"),
        dattablespace = row[Long](prefix + "dattablespace"),
        datacl = row[Option[Array[PGobject]]](prefix + "datacl")
      )
    )
  }

  implicit val oFormat: OFormat[PgDatabaseRow] = new OFormat[PgDatabaseRow]{
    override def writes(o: PgDatabaseRow): JsObject =
      Json.obj(
        "oid" -> o.oid,
      "datname" -> o.datname,
      "datdba" -> o.datdba,
      "encoding" -> o.encoding,
      "datcollate" -> o.datcollate,
      "datctype" -> o.datctype,
      "datistemplate" -> o.datistemplate,
      "datallowconn" -> o.datallowconn,
      "datconnlimit" -> o.datconnlimit,
      "datlastsysoid" -> o.datlastsysoid,
      "datfrozenxid" -> o.datfrozenxid,
      "datminmxid" -> o.datminmxid,
      "dattablespace" -> o.dattablespace,
      "datacl" -> o.datacl
      )

    override def reads(json: JsValue): JsResult[PgDatabaseRow] = {
      JsResult.fromTry(
        Try(
          PgDatabaseRow(
            oid = json.\("oid").as[PgDatabaseId],
            datname = json.\("datname").as[String],
            datdba = json.\("datdba").as[Long],
            encoding = json.\("encoding").as[Int],
            datcollate = json.\("datcollate").as[String],
            datctype = json.\("datctype").as[String],
            datistemplate = json.\("datistemplate").as[Boolean],
            datallowconn = json.\("datallowconn").as[Boolean],
            datconnlimit = json.\("datconnlimit").as[Int],
            datlastsysoid = json.\("datlastsysoid").as[Long],
            datfrozenxid = json.\("datfrozenxid").as[PGobject],
            datminmxid = json.\("datminmxid").as[PGobject],
            dattablespace = json.\("dattablespace").as[Long],
            datacl = json.\("datacl").toOption.map(_.as[Array[PGobject]])
          )
        )
      )
    }
  }
}
